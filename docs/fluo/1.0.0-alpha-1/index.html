<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" integrity="sha384-h21C2fcDk/eFsW9sC9h0dhokq5pDinLNklTKoxIZRUn3+hvmgQSffLLQ4G4l2eEr" crossorigin="anonymous">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/fluo.css">
    <link rel="canonical" href="https://fluo.apache.org//docs/fluo/1.0.0-alpha-1/">
    <link rel="icon" type="image/png" href="/resources/favicon.png">
    
    <title>Fluo 1.0.0-alpha-1 Documentation | Apache Fluo</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <!-- Place your <script> tags here. -->

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55360307-1', 'auto');
  ga('send', 'pageview');

</script>

<script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));</script>

  </head>
  <body style="padding-top: 100px">
    <nav id="fluo-nav" class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <div class="navbar-toggle-wrapper visible-xs">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".js-navbar-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
          </div>
          <a href="/" class="navbar-brand"><img id="fluo-img" height="40px" src="/resources/fluo-logo-dark.png" alt="Apache Fluo"></a>
        </div>
        <div class="collapse navbar-collapse js-navbar-collapse" style="margin-top: 20px">
          <ul class="navbar-nav nav">
            <li><a href="/release/">Releases</a></li>
            <li><a href="/tour/">Tour</a></li>
            <li><a href="/docs/">Docs</a></li>
            <li><a href="/api/">API</a></li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">Community<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="/getinvolved/">Get Involved</a></li>
                <li><a href="/news/">News Archive</a></li>
                <li><a href="/people/">People</a></li>
                <li><a href="/related-projects/">Related Projects</a></li>
                <li><a href="/poweredby/">Powered By</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">Contributing<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="/how-to-contribute/">How To Contribute</a></li>
                <li><a href="/release-process/">Release Process</a></li>
              </ul>
            </li>
          </ul>
          <ul class="navbar-nav nav navbar-right">
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">Apache Software Foundation<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="https://www.apache.org">Apache Homepage</a></li>
                <li><a href="https://www.apache.org/licenses/LICENSE-2.0">License</a></li>
                <li><a href="https://www.apache.org/foundation/sponsorship">Sponsorship</i></a></li>
                <li><a href="https://www.apache.org/security">Security</a></li>
                <li><a href="https://www.apache.org/foundation/thanks">Thanks</a></li>
                <li><a href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container">
      <div class="row">
          <div class="col-sm-12">
            <div class="fluo-doc">

  
  <div class="alert alert-danger" role="alert">These docs are for Fluo 1.0.0-alpha-1 which is an old version! Check out the <a href="/docs/fluo/1.1.0-incubating/">latest docs</a>!</div>
  

  
  <div class="alert alert-danger" role="alert">These docs are for a release of Fluo made before Apache incubation.</div>
  

  <header class="post-header">
    <h2 class="post-title">Fluo 1.0.0-alpha-1 Documentation</h2>
  </header>

  <article id="page-content">
    <p>Fluo is a <a href="http://research.google.com/pubs/pub36726.html">Percolator</a> prototype for <a href="http://accumulo.apache.org">Accumulo</a>.  This prototype relies on 
Accumulo 1.6.0 which has <a href="https://issues.apache.org/jira/browse/ACCUMULO-1000">ACCUMULO-1000</a> and <a href="https://issues.apache.org/jira/browse/ACCUMULO-112">ACCUMULO-112</a>.
<a href="https://issues.apache.org/jira/browse/ACCUMULO-1000">ACCUMULO-1000</a> makes cross row transactions possible and  <a href="https://issues.apache.org/jira/browse/ACCUMULO-112">ACCUMULO-112</a>
makes it possible to efficiently find notifications.  Theoretically, this
prototype is to a point where it could run in a distributed manner.  But this
has not been tested.  The pieces are in place, CAS is done on the tablet server
and the Oracle is a service.</p>

<p>There is a lot that needs to be done.  If you are interested in contributing
send me an email or check out the issues.</p>

<p>If you want to experiment with Fluo, check out the <a href="https://github.com/fluo-io/phrasecount">phrasecount</a> example.
This example is a simple end-to-end application that is super easy to run.  It
also has handling for real world problems like high cardinality phrases.</p>

<h2 id="building-fluo">Building Fluo</h2>

<p>Using Maven, you can build Fluo with the following steps.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>git clone https://github.com/fluo-io/fluo.git
cd fluo
mvn package
</code></pre>
</div>

<p>Running <code class="highlighter-rouge">mvn package</code> will build a tar ball that contains all of the
dependencies needed at runtime.  Currently the tar ball is targeted towards
Hadoop 2.3.0 and Accumulo 1.6.0.  If you have different versions installed on
your cluster, you can try passing the following options to maven package.
Other versions of Hadoop and Accumulo may not work, please open a bug if you
run into problems.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>mvn package -Daccumulo.version=1.6.1-SNAPSHOT -Dhadoop.version=2.4.0
</code></pre>
</div>

<p>Once the tarball is built, deploy it using the command below which can be modified
to a directory of your choice (rather than <code class="highlighter-rouge">/opt</code>).</p>

<div class="highlighter-rouge"><pre class="highlight"><code>tar -C /opt -xvzf modules/distribution/target/fluo-1.0.0-alpha-1-SNAPSHOT-bin.tar.gz
</code></pre>
</div>

<h2 id="configuring-fluo">Configuring Fluo</h2>

<p>To configure and run Fluo, you will need a running Accumulo instance as well 
as an observer jar to run with Fluo.  If you have not created your own observer
jar, you can build an observer jar using the <a href="https://github.com/fluo-io/phrasecount">phrasecount</a> example.</p>

<p>First, copy the example configuration files and modify them for you environment.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>cd fluo-1.0.0-alpha-1-SNAPSHOT/conf
cp examples/* .
vim fluo-env.sh
vim fluo.properties
</code></pre>
</div>

<p>Copy your observer jar to Fluo and set up notifications to your observer in
 <code class="highlighter-rouge">fluo.properties</code>.  Check out <a href="https://github.com/fluo-io/phrasecount">phrasecount</a> to build an example observer
 jar and find instructions for configuring <code class="highlighter-rouge">fluo.properties</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>OBSERVER_JAR=&lt;location of observer jar&gt;
cd fluo-1.0.0-alpha-1-SNAPSHOT/
cp $OBSERVER_JAR lib/observers
vim conf/fluo.properties
</code></pre>
</div>

<p>Finally, initialize your instance which only needs to be called once and stores
 configuration in zookeeper.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>./bin/initialize.sh
</code></pre>
</div>

<h2 id="running-fluo">Running Fluo</h2>

<p>A Fluo instance consists of 1 oracle process and multiple worker processes.
These processes can either be run on a YARN cluster or started locally on each
machine.</p>

<p>The preferred method to run Fluo applications is using YARN which will start
up multiple workers as configured in <code class="highlighter-rouge">fluo.properties</code>.  To start a Fluo cluster 
in YARN, run following commands:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>./bin/oracle.sh start-yarn
./bin/worker.sh start-yarn
</code></pre>
</div>

<p>The <code class="highlighter-rouge">start-yarn</code> commands above submit your Fluo applications to YARN.  Therefore, 
they work for a single-node or a large cluster.  By using YARN, you no longer need 
to deploy the Fluo binaries to every node on your cluster or start processes on 
every node.</p>

<p>You can use <code class="highlighter-rouge">yarn application -list</code> to check the status of the applications. 
Logs are viewable within YARN.  When finished, you can kill the applications
using <code class="highlighter-rouge">yarn application -kill &lt;Application ID&gt;</code>.  The application ID can be
found using the list command.</p>

<p>If you do not have YARN set up, you can start a local Fluo process using
the following commands:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>./bin/oracle.sh start-local
./bin/worker.sh start-local
</code></pre>
</div>

<p>In a distributed environment, you will need to deploy the Fluo binary to 
every node and start each process individually.</p>

<p>To stop Fluo processes, run the following commands:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>./bin/worker.sh stop-local
./bin/oracle.sh stop-local
</code></pre>
</div>

<h2 id="tuning-accumulo">Tuning Accumulo</h2>

<p>Fluo will reread the same data frequently when it checks conditions on
mutations.   When Fluo initializes a table it enables data caching to make
this more efficient.  However you may need to increase the amount of memory
available for caching in the tserver by increasing <code class="highlighter-rouge">tserver.cache.data.size</code>.
Increasing this may require increasing the maximum tserver java heap size in
<code class="highlighter-rouge">accumulo-env.sh</code>.</p>

<p>Fluo will run many client threads, will want to ensure the tablet server
has enough threads.  Should probably increase the
<code class="highlighter-rouge">tserver.server.threads.minimum</code> Accumulo setting.</p>

<p>Using at least Accumulo 1.6.1 is recommended because multiple performance bugs
were fixed.</p>

<h2 id="additional-documentation">Additional Documentation</h2>

<p><a href="stress/">Stress Testing</a></p>


  </article>

</div>

          </div>
      </div>
      <hr>
      <div class="row footer">
        <div class="col-sm-12 text-center">
          <div class="center-block">
          <a href="https://apache.org"><img src="/resources/feather.png" alt="Apache"></a>
          Copyright &copy; 2017 The Apache Software Foundation. Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache&nbsp;License,&nbsp;Version&nbsp;2.0</a>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
